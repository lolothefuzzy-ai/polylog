<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Polylog Frontend Example</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: system-ui, -apple-system, sans-serif;
        background: #0a0e27;
        color: #e0e0e0;
        padding: 30px;
        line-height: 1.6;
      }
      
      h1 {
        color: #ff3333;
        margin-bottom: 30px;
        font-size: 2.5em;
        text-shadow: 0 2px 10px rgba(255, 51, 51, 0.3);
      }
      
      h3 {
        color: #4169e1;
        margin-top: 25px;
        margin-bottom: 15px;
        font-size: 1.3em;
      }
      
      .row {
        margin: 15px 0;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
      }
      
      button {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        font-weight: bold;
        font-size: 0.95em;
        cursor: pointer;
        transition: all 0.2s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      #add-square, #add-triangle, #list-polyforms {
        background: #ff3333;
        color: white;
      }
      
      #add-square:hover, #add-triangle:hover, #list-polyforms:hover {
        background: #ff5555;
        box-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
        transform: translateY(-2px);
      }
      
      #evaluate, #place {
        background: #4169e1;
        color: white;
      }
      
      #evaluate:hover, #place:hover {
        background: #5a7fef;
        box-shadow: 0 0 15px rgba(65, 105, 225, 0.5);
        transform: translateY(-2px);
      }
      
      #start-exploration, #get-stats {
        background: #9932cc;
        color: white;
      }
      
      #start-exploration:hover, #get-stats:hover {
        background: #bb44ff;
        box-shadow: 0 0 15px rgba(153, 50, 204, 0.5);
        transform: translateY(-2px);
      }
      
      #stop-exploration {
        background: #cc3333;
        color: white;
      }
      
      #stop-exploration:hover {
        background: #ff4444;
        box-shadow: 0 0 15px rgba(204, 51, 51, 0.5);
        transform: translateY(-2px);
      }
      
      #estimate {
        background: linear-gradient(135deg, #4169e1, #9932cc);
        color: white;
      }
      
      #estimate:hover {
        box-shadow: 0 0 20px rgba(65, 105, 225, 0.6);
        transform: translateY(-2px);
      }
      
      input {
        padding: 10px 15px;
        background: #1a1f3a;
        border: 2px solid #4169e1;
        border-radius: 6px;
        color: #e0e0e0;
        font-size: 0.95em;
        transition: all 0.2s ease;
      }
      
      input:focus {
        outline: none;
        border-color: #ff3333;
        box-shadow: 0 0 10px rgba(255, 51, 51, 0.3);
        background: #222640;
      }
      
      input::placeholder {
        color: #666b8a;
      }
      
      pre {
        background: #0f1428;
        border: 2px solid #4169e1;
        border-radius: 8px;
        padding: 15px;
        max-height: 350px;
        overflow: auto;
        color: #00ff00;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        box-shadow: inset 0 0 20px rgba(65, 105, 225, 0.1);
      }
      
      pre::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      
      pre::-webkit-scrollbar-track {
        background: #1a1f3a;
      }
      
      pre::-webkit-scrollbar-thumb {
        background: #4169e1;
        border-radius: 4px;
      }
      
      pre::-webkit-scrollbar-thumb:hover {
        background: #5a7fef;
      }
    </style>
  </head>
  <body>
    <h1>Polylog Frontend Example</h1>

    <div class="row">
      <button id="add-square">Add Square</button>
      <button id="add-triangle">Add Triangle</button>
      <button id="list-polyforms">List Polyforms</button>
    </div>

    <div class="row">
      <input id="target-id" placeholder="target_id" />
      <input id="candidate-id" placeholder="candidate_id" />
      <button id="evaluate">Evaluate</button>
      <button id="place">Place</button>
    </div>

    <div class="row">
      <button id="start-exploration">Start Exploration</button>
      <button id="stop-exploration">Stop Exploration</button>
      <button id="get-stats">Get Stats</button>
    </div>

    <h3>Estimator</h3>
    <div class="row">
      <input id="T" type="number" step="0.1" placeholder="T" value="10" />
      <input id="types" style="width:420px" placeholder='types JSON e.g. [{"a":3,"c":2},{"a":4,"c":6},{"a":6,"c":1}]' />
      <input id="sym" type="number" step="0.01" placeholder="symmetry_factor" value="1" />
      <button id="estimate">Estimate N</button>
    </div>

    <h3>Output</h3>
    <pre id="out"></pre>

    <script>
      const API = 'http://localhost:8000';
      const out = document.getElementById('out');
      const setOut = (data) => { out.textContent = JSON.stringify(data, null, 2); };

      async function post(path, body) {
        const res = await fetch(`${API}${path}`, {
          method: 'POST', headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body || {})
        });
        return res.json();
      }
      async function get(path) {
        const res = await fetch(`${API}${path}`);
        return res.json();
      }

      document.getElementById('add-square').onclick = async () => {
        const r = await post('/assembly/polyforms', { type:'polygon', sides:4 });
        setOut(r);
      };
      document.getElementById('add-triangle').onclick = async () => {
        const r = await post('/assembly/polyforms', { type:'polygon', sides:3 });
        setOut(r);
      };
      document.getElementById('list-polyforms').onclick = async () => {
        setOut(await get('/assembly/polyforms'));
      };

      document.getElementById('evaluate').onclick = async () => {
        const target_id = document.getElementById('target-id').value;
        const candidate_id = document.getElementById('candidate-id').value;
        setOut(await post('/placement/evaluate', { target_id, candidate_id }));
      };
      document.getElementById('place').onclick = async () => {
        const target_id = document.getElementById('target-id').value;
        const candidate_id = document.getElementById('candidate-id').value;
        setOut(await post('/placement/place', { target_id, candidate_id }));
      };

      document.getElementById('start-exploration').onclick = async () => {
        setOut(await post('/exploration/start', { strategy:'balanced', seed_sides:4 }));
      };
      document.getElementById('stop-exploration').onclick = async () => {
        setOut(await post('/exploration/stop'));
      };
      document.getElementById('get-stats').onclick = async () => {
        setOut(await get('/exploration/stats'));
      };

      document.getElementById('estimate').onclick = async () => {
        try {
          const T = parseFloat(document.getElementById('T').value);
          const types = JSON.parse(document.getElementById('types').value || '[]');
          const symmetry_factor = parseFloat(document.getElementById('sym').value || '1');
          const body = { T, types, symmetry_factor };
          setOut(await post('/estimator/estimate', body));
        } catch (e) {
          setOut({ error: String(e) });
        }
      };
    </script>
  </body>
</html>
