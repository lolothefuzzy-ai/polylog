#pragma once\n#include <vector>\n#include <string>\n#include <unordered_map>\n#include <memory>\n\nnamespace polylog::render {\n\nenum class ResourceAccess { Read, Write, ReadWrite };\nenum class PipelineStage { EarlyZ, ColorOutput, Transfer, Compute };\n\nstruct FrameGraphPassDesc {\n    std::string name;\n    std::vector<std::string> read_resources;\n    std::vector<std::string> write_resources;\n    PipelineStage stage = PipelineStage::ColorOutput;\n    std::string shader_name;  // For render passes\n};\n\nstruct FrameGraphResourceDesc {\n    std::string name;\n    uint32_t width, height;\n    uint32_t depth = 1;\n    std::string format;  // RGBA8, RGBA16F, etc.\n    bool transient = true;  // Per-frame; reclaimed after use\n};\n\n/**\n * STAB-008: Frame graph (render graph) MVP.\n * Encodes pass dependencies and resource lifetimes explicitly.\n * Auto-generates barriers and validates DAG.\n */\nclass FrameGraph {\npublic:\n    FrameGraph() = default;\n    ~FrameGraph() = default;\n    \n    void AddPass(const FrameGraphPassDesc& pass);\n    void AddResource(const FrameGraphResourceDesc& res);\n    \n    /// Compile DAG and generate barriers\n    bool Compile();\n    \n    /// Get barriers for a pass\n    const std::vector<std::string>& GetBarriers(const std::string& pass_name) const;\n    \n    /// Debug: DOT format for visualization\n    std::string DumpDOT() const;\n    \n    /// Query resource lifetime\n    bool GetResourceLifetime(const std::string& res_name, \n                             uint32_t& first_pass_idx, \n                             uint32_t& last_pass_idx) const;\n    \nprivate:\n    std::unordered_map<std::string, FrameGraphPassDesc> passes_;\n    std::unordered_map<std::string, FrameGraphResourceDesc> resources_;\n    std::unordered_map<std::string, std::vector<std::string>> barriers_;\n    std::vector<std::string> pass_order_;  // Topologically sorted\n    \n    void ValidateDAG();\n    void GenerateBarriers();\n    void TopologicalSort();\n};\n\n}  // namespace polylog::render\n